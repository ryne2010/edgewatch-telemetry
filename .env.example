# ---- Core ----
APP_ENV=dev
LOG_LEVEL=INFO

# Logging format:
# - text (developer-friendly)
# - json (Cloud Logging friendly)
LOG_FORMAT=text

# Postgres (Docker Compose default)
DATABASE_URL=postgresql+psycopg://edgewatch:edgewatch@db:5432/edgewatch

# Automatically run Alembic migrations on API startup.
# When using docker compose, migrations are run by the `migrate` service, so keep this OFF.
# If you run the API directly (no compose), set AUTO_MIGRATE=1.
# In production, prefer running migrations as a separate Cloud Run Job (see docs).
AUTO_MIGRATE=0

# Admin key for provisioning devices (do NOT use this in prod)
ADMIN_API_KEY=dev-admin-key

# Enable/disable in-process scheduler (offline check). In production, disable this
# and trigger the Cloud Run Job entrypoint instead (python -m api.app.jobs.offline_check).
ENABLE_SCHEDULER=1

# Disable OpenAPI/docs in non-dev envs by default (override if you want docs enabled).
# ENABLE_DOCS=1

# PBKDF2 iteration count for hashing device tokens.
# Higher is slower/safer; tune for your fleet.
TOKEN_PBKDF2_ITERATIONS=210000

# Offline monitor runs every N seconds
OFFLINE_CHECK_INTERVAL_S=30

# Edge policy contract (device optimization + thresholds)
EDGE_POLICY_VERSION=v1

# Optional override (quick experimentation). Prefer editing contracts/edge_policy/*.
# DEFAULT_WATER_PRESSURE_LOW_PSI=30.0

# Telemetry data contract
TELEMETRY_CONTRACT_VERSION=v1
# If true (recommended), known metrics must match the declared type.
# Unknown keys are still accepted (additive drift) but recorded in ingestion batches.
TELEMETRY_CONTRACT_ENFORCE_TYPES=1

# CORS (set to * for local dev only)
CORS_ALLOW_ORIGINS=*

# If enabled, creates a demo device automatically on startup (dev only)
BOOTSTRAP_DEMO_DEVICE=1
# Number of demo devices to create. If DEMO_DEVICE_ID/NAME/TOKEN end with `001`,
# the remaining devices will be derived by incrementing that 3-digit suffix.
DEMO_FLEET_SIZE=3
DEMO_DEVICE_ID=demo-well-001
DEMO_DEVICE_NAME=Demo Well 001
DEMO_DEVICE_TOKEN=dev-device-token-001
